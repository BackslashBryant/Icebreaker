---
description: "MCP Integrations – GitHub, Supabase, Playwright, Desktop Commander, DocFork"
globs: ["**/*"]
alwaysApply: true
---

# MCP Integrations

These MCP servers are accelerators—not autopilot. Use them when they reduce risk, cite outputs when they influence a decision, and fall back to the CLI only when the MCP path is blocked.

## Principles
- Stay in ticket scope. Propose the exact command/query before running it and wait for approval.
- Prefer scripted helpers (see `tools/` and `examples/automation/`) so operations are reproducible.
- Log meaningful results (links, summaries, screenshots) in `/docs/research.md`, `artifacts/`, or the relevant doc.
- If an MCP fails twice, document it in `.notes/features/<slug>/progress.md` and suggest the fallback.

## When to Reach for Which Tool
- **GitHub MCP** – Branch/PR automation, repo search, code examples. First stop for anything “git” or GitHub API shaped.
- **DocFork MCP** – Official documentation lookups, code examples, version notes. Cite the source in `/docs/research.md`.
- **Playwright MCP** – UI screenshots, axe/Lighthouse accessibility/perf checks. Attach outputs to the ticket or artifacts.
- **Supabase MCP** – Database schema diffs, SQL experiments, policy checks. Update `docs/ConnectionGuide.md` when endpoints change.
- **Desktop Commander MCP** – Local shell/file automation aligned with the allowlist in `.cursor/tools/policy.md`.

## Plan vs Act Expectations
1. **Plan Mode** – State which MCP you intend to use, the command/query, expected outcome, and rollback. Await approval.
2. **Act Mode** – Execute exactly what was approved. Share the raw output (trimmed) plus a one-line interpretation.
3. **Log** – Place citations or artifacts where the next agent will find them (`/docs/research.md`, `artifacts/<issue>/…`, README updates via Muse, etc.).

## Health Checks
- Run `npm run preflight` at the start of a session to confirm baseline MCP servers respond.
- `npm run mcp:suggest` highlights additional servers worth enabling; document decisions in `.notes/features/<slug>/progress.md`.
- Nexus records any credential or config changes in `docs/ConnectionGuide.md` before closing a task.

## Fallback Protocol
1. Pause and report the outage (include the MCP name and error).
2. Suggest an approved fallback (CLI, SDK, manual step) if it stays within scope.
3. Capture the variance in the plan or Current Issues log so future runs know why the MCP was skipped.

Treat MCP usage with the same care as code changes—propose, approve, execute, and document.
