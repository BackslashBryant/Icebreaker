---
description: "Complete Development Workflow - Triage, Plan, Build, Verify, PR with Spec Kit and GitHub Issues"
globs: ["**/*"]
alwaysApply: true
---

# Complete Development Workflow

## 1) Triage
- Confirm scope, inputs/outputs, constraints, and success criteria.
- List blockers or unknowns explicitly in the ticket.
- **AUTOMATIC**: Analyze request complexity, risk, and scope to determine workflow.
- **AUTOMATIC**: Use Spec Kit slash commands if available and complexity/risk is high, otherwise use GitHub Issues.
- Create GitHub Issue with proper labels and acceptance criteria.

### MCP Checkpoint (mandatory when applicable)
- Research: Built-in web search (current standards), GitHub MCP (patterns), DocFork MCP (official docs).
- Current state (UI/UX tickets): Playwright MCP quick screenshot/accessibility check.

## 2) Plan
- **IF Spec Kit available**: Use `/constitution`, `/clarify`, `/plan` slash commands for complex tasks.
- **IF GitHub Issues workflow**: Draft a mini-plan (3-6 bullets) with risks and selected checks from scripts/verify-all.
- Choose the smallest viable change; avoid architecture shifts unless ticketed.

## 3) Build
- **IF Spec Kit available**: Use `/implement` slash command to execute tasks.
- **IF GitHub Issues workflow**: Make small, reversible commits and include the ticket ID in messages.
- Modify existing code when possible; keep public APIs stable unless ticketed.

### MCP Checkpoint (while building)
- UI changes: Playwright MCP screenshots and axe checks for impacted screens.
- DB changes: Supabase MCP schema/logs/advisors validation.
- Git operations: GitHub MCP for repository management and operations.

## 4) Verify
- **IF Spec Kit available**: Use Spec Kit validation features.
- **IF GitHub Issues workflow**: Run scripts/verify-all (lint, types, tests, build).
- Capture artifacts such as logs, screenshots, or CLI output.
- When tightening auth or API boundaries, validate both the route and each consuming hook or service and record the check you ran.

### MCP Quality Gates
- UI/Accessibility/Performance scopes: Playwright MCP Lighthouse/Core Web Vitals + axe report required.
- Database scopes: Supabase MCP advisors/logs snapshot required.
- Research scopes: Built-in web search findings summary linked.

## 5) PR
- Use the PR template and request only relevant code owners.
- Link the ticket and include summary, risk note, evidence, and backout plan.

## 6) Ticket Completion (MANDATORY AUTOMATIC WORKFLOW)
**CRITICAL**: All steps must be completed AUTOMATICALLY before marking ticket as done.

### 6.0 Spec Kit Completion (IF Spec Kit workflow)
- **AUTOMATIC**: Validate all requirements and scenarios are met
- **AUTOMATIC**: Update Spec Kit implementation status to completed
- **AUTOMATIC**: Archive Spec Kit implementation artifacts
- **AUTOMATIC**: Update specifications if needed

### 6.1 Git Operations (MANDATORY AUTOMATIC - NO EXCEPTIONS)
**AUTOMATIC EXECUTION REQUIRED** - See `.cursor/rules/02-quality.mdc` for complete git workflow details.

**NO USER REMINDERS ALLOWED** - The complete git workflow must execute automatically.

### 6.2 Ticket Management (GitHub Issues-First)
- [ ] Update GitHub Issue status to "COMPLETED"
- [ ] Mark all acceptance criteria as complete in issue
- [ ] Add completion summary as issue comment
- [ ] Close GitHub Issue when work is complete
- [ ] Update `docs/tickets/TICKET_PLAN.md` status (if still using)

### 6.3 Documentation Updates
- [ ] Update `docs/PRD.md` Change Log with completion entry
- [ ] Document any new patterns or learnings
- [ ] Update any affected architecture documentation

### 6.4 Quality Gates (NO BYPASSING)
- [ ] All pre-commit hooks pass (fix underlying issues, don't use --no-verify)
- [ ] All pre-push hooks pass (fix underlying issues, don't use --no-verify)
- [ ] TypeScript compilation successful
- [ ] Linting passes
- [ ] Tests pass
- [ ] Build successful

### 6.5 Process Improvement
- [ ] Identify any workflow gaps or issues encountered
- [ ] Propose solutions for process improvements
- [ ] Update rules if new patterns discovered

**FAILURE TO COMPLETE ANY STEP = TICKET NOT COMPLETE**

---

# GitHub Issues-First Workflow

## New Workflow: GitHub Issues-First
- **Create**: Issues directly in GitHub with proper labels and structure
- **Track**: Use GitHub Issues for all ticket management
- **Complete**: Close issues when work is done with proper documentation
- **Link**: PRs automatically reference issues for tracking

## Required Fields (GitHub Issue)
- **Title**: Clear, descriptive title with ticket ID
- **Body**: Objective, scope, acceptance criteria, priority, assignee
- **Labels**: Priority, type, component, status
- **Assignee**: Team member responsible

## Rules
- No work before GitHub Issue **creation**.
- One issue per PR (or clearly stated grouped subtasks).
- Close GitHub Issue only after **evidence** meets acceptance criteria.
- Link PR â†” GitHub Issue; update issue with progress comments.
- Use GitHub MCP for all issue management operations.

## Legacy Support
- Local ticket files in `docs/tickets/` are now **archived**
- Old sync system moved to `docs/archived/sync-system/`
- GitHub Issues are now the **single source of truth**

## GitHub Issue Template
```markdown
## ðŸŽ¯ Goal
[Brief description of what needs to be accomplished]

## ðŸ§© Background
[Context and rationale for this issue]

## ðŸ“‹ Tasks
- [ ] Task 1
- [ ] Task 2
- [ ] Task 3

## ðŸ§ª Acceptance Criteria
- [ ] Technical criteria met
- [ ] Tests updated
- [ ] Docs updated
- [ ] No regressions introduced

## ðŸ”— Related
- PRD section: `docs/PRD.md#section`
- Related issues: #123, #456
- Design: Figma, Loom, etc.

## ðŸ§¾ Notes
[Additional context, blockers, or considerations]
```

## Issue Labels
- **Priority**: `priority:high`, `priority:medium`, `priority:low`
- **Type**: `type:feature`, `type:bug`, `type:chore`, `type:docs`
- **Component**: `component:frontend`, `component:backend`, `component:infra`
- **Status**: `status:open`, `status:in-progress`, `status:review`, `status:done`

## Workflow Integration
- Issues automatically linked to PRs
- PR status updates issue progress
- Issue closure triggers documentation updates
- Issue completion updates project status

---

# Spec Kit Integration

## When to Use Spec Kit

**Use Spec Kit slash commands for:**
- Complex features affecting multiple components
- Breaking changes or API modifications
- Architecture decisions
- Multi-step implementations with dependencies
- When user explicitly requests Spec Kit usage

**Use GitHub Issues workflow for:**
- Simple bug fixes (single file, <50 lines)
- Typo corrections or formatting
- Documentation-only changes
- Test additions for existing functionality
- Dependency updates without behavior changes

## Spec Kit Workflow

1. **Start with `/constitution`** - Establish project principles
2. **Use `/specify`** - Define what to build
3. **Use `/clarify`** - Clarify any underspecified areas
4. **Use `/plan`** - Create technical implementation plan
5. **Use `/tasks`** - Generate actionable task list
6. **Use `/implement`** - Execute the implementation

## Integration with Existing Workflow

- Spec Kit enhances existing GitHub Issues workflow
- All existing git automation continues to work
- MCP integrations remain functional
- Quality gates are maintained