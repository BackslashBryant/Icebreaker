---
description: "GitHub-first sequential Agent workflow"
globs: ["**/*"]
alwaysApply: true
---

# GitHub-Centric Workflow

This repo assumes GitHub hosts the project, issues drive the work, and Cursor Agents execute sequentially. Every contribution should leave an auditable trail in GitHub (issues, branches, PRs, checks).

## 0. Start From a GitHub Issue
- Every feature, bug, or spike starts as an Issue.
- If none exists, open one with the appropriate template (`/.github/ISSUE_TEMPLATE/`).
- Reference the issue URL in `/docs/Plan.md`, commits, and PR description.

## 1. Plan (Vector)
- Use Cursor Plan Mode with the issue context.
- Save the plan to `/docs/Plan.md` (3-7 steps, acceptance tests, owners).
- Add labels: `agent:vector`, relevant implementer labels, and `status:plan`.
- If Docfork/Search MCP is used, note the references in `/docs/research.md`.

## 2. Branching & MCP Setup
- Branch name format: `agent/<agent>/<issue>-<slug>` (e.g. `agent/link/1234-header`).
- Install/refresh GitHub MCP in Cursor; authenticate using a PAT with `repo`, `workflow`, `issues`.
- Nexus or the acting human runs `npm run agents:install-hook` to copy the path-scope pre-commit hook locally.
- Run `npm run preflight` before pushing to ensure scaffolding is intact.
- Execute `npm run mcp:suggest` after dependency or config changes and note the recommendations in `.notes/` or the active plan; run `npm run mcp:suggest -- --install <id>` to append required servers to `.cursor/mcp.json`.

## 3. Implement (Forge/Link/Glide/Apex/Cider)
- Work within your agent branch and path scope.
- Commit early/often; reference the issue (`#1234`) in commit messages.
- Push to GitHub and open a Draft PR immediately. Assign labels per agent (`agent:forge` etc.) and set status `status:build`.
- Use GitHub MCP (or `gh`) for branch pushes, PR updates, and reviews. Terminal git is a fallback.

## 4. Verify (Pixel, Muse, Nexus, Sentinel)
- Pixel runs `npm run verify` (or agreed scripts) and reports in the PR; update status label to `status:verify`.
- `npm run verify` surfaces the MCP suggestion summary; log any add/remove actions before marking verification complete.
- Muse updates README/CHANGELOG/docs, cites tests, and checks in changes.
- Nexus confirms GitHub Actions succeeded, configures environment variables/Secrets, and keeps status checks enforced.
- Sentinel jumps in for auth/secret/PII-sensitive work, leaving notes under `/docs/security/`.

## 5. Pull Request Expectations
- PR template (see `.github/PULL_REQUEST_TEMPLATE.md`) must include:
  - Summary with issue link.
  - Local verification commands + results.
  - Checklist: Plan updated, Tests run, Docs updated, Research logged.
- Require:
  - Passing `Template CI` workflow.
  - Approvals from owners defined in `CODEOWNERS`.
  - Labels updated to `status:done` before merge.
- Nexus (or human counterpart) merges via GitHub UI once requirements are satisfied.

## 6. Close the Loop
- Close the Issue with a recap that links the merged PR and any follow-on tasks.
- Archive research snippets in `/docs/research.md` and security notes (if any).
- Update `/docs/agents/KICKOFF.md` sanity checklist if the flow uncovered gaps.

## Tooling & Automation
- `npm run agents:prompt -- all` prints prompt bodies for all agents.
- `npm run agents:install-hook` copies the optional path-scope guard into `.git/hooks`.
- `npm run github:labels` (future helper) will seed repo labels defined in `/docs/github/labels.json`.
- GitHub Actions (`.github/workflows/`) run preflight + `verify-all`. Extend them as the stack evolves.

## Guardrails
- Never merge directly to `main`. Enforce branch protections: require PR, passing checks, linear history.
- Keep secrets in GitHub Actions secrets or environment variables; never commit `.env` files.
- If MCP access changes (new services, revoked tokens), open an issue for Nexus to update `.cursor/config.json` and automation.
- **Repository Mode**: Template repos track Cursor files (`.cursor/`). App repos block them. The pre-commit hook enforces this separation. See `docs/development/SEPARATION.md` for mode conversion and override procedures.

Follow this loop for every change to keep GitHub the source of truth and Cursor Agents accountable.***
