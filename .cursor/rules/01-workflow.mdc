---
description: "Vibe-first workflow"
globs: ["**/*"]
alwaysApply: true
---

# Vibe Workflow Overview

## 0. Anchor to GitHub
- Every session starts from a GitHub Issue. If one does not exist, create it (or ask the user to describe the vision so Cursor can open one).
- Record the issue URL/ID in the Plan Mode prompt, saved plan filename, and vibe logs (tag entries with the issue ID using the supplied `scripts/vibe-session` helper or equivalent).
- Keep branches issue-scoped (`1234-short-slug`) and reference the issue in commits/PRs so GitHub stays the system of record.

## 1. Align
- Declare goal, polish level, and known constraints in chat.
- Load or create a Plan Mode plan before touching files.
- Drop supporting context in `.notes/` if the session spans more than a few edits.
- When the stack is established or changes materially, run the **Stack Integration** plan template (`.cursor/plans/templates/stack-integration.md`) and execute `node tools/stack-wire.mjs --inspect/--apply` so lint/test/build scripts and CI stay in sync.

## 2. Plan & Queue
- Let Agent ask clarifying questions; answer quickly.
- Save plan to `.cursor/plans/` if it will survive the session.
- Queue follow-up prompts with **Ctrl+Enter** so instructions keep flowing while Agent works.
- Include an "MCP audit" step whenever the stack shifts: run `node tools/mcp-audit.mjs`, paste the report into the GitHub issue, and verify matching MCP servers are enabled/disabled accordingly.

## 3. Build
- **MCP-FIRST MANDATORY**: Before any git operations (commit, push, branch, PR), check MCP triggers in 04-integrations.mdc
- **Git Operations**: Use GitHub MCP for all git operations (commit, push, branch, PR) - terminal commands are fallback only
- Operate in vibe mode by default: small reversible chunks, narrate decisions.
- Reference docs or targeted rules manually (e.g. `@docs/library/library-reference.md`) when depth is required.
- Stop Agent when things go off track and restate intent instead of letting it spiral.

## 4. Validate
- Run the repo's verification helper (`scripts/verify-all` via your preferred package runner) for fast assurance; escalate to stack-specific scripts when shipping.
- Capture console output or screenshots in `artifacts/` for wins and regressions.
- Respect YOLO guardrails: allow the agent to run lint/test/build, but always review diffs.

## 5. Close the Loop
- Update the plan/TODOs with what happened and what's next.
- Queue a final message if someone will pick up later.
- Log discoveries via the vibe logging helper (pass `--note "..."`) and add lessons to `.cursor/rules/07-process-improvement.mdc`.
- If the MCP audit surfaced changes (e.g. new database/server/testing needs), open or update a GitHub Issue to track adding/removing the relevant MCP entries in `.cursor/mcp.json`, and note the recommendation in the final summary.

## Optional Structured Mode
When you need formal specs or compliance artefacts, run the Spec Kit bootstrap helper (`tools/bootstrap-spec-kit.mjs` via Node/uv/your runtime), enable Spec Kit commands, and reintroduce heavier verification. Until then, keep the vibe light.

## New Project Safeguard
- Clone this template but immediately add the real remote (e.g. `git remote set-url origin git@github.com:you/new-repo.git`) or push to a fork. Never ship work against the template origin.
- Capture the target repo in the first GitHub Issue/plan so Cursor knows where PRs should land.
- After cloning, review `.cursor/mcp.json` and disable unused defaults. During planning, recommend enabling or adding MCPs that match the chosen stack (e.g. database MCP when a DB is introduced, UI test MCP for frontend-heavy work).